<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <query name="GetRecentMessageId">
        <![CDATA[
        from FormMessages where RelatedFormGUID=:form and PostedAt=:PostedAt
        ]]>
    <query-param name="form" type="java.lang.String"/>
    <query-param name="PostedAt" type="java.sql.Timestamp"/>
    </query>

    <query name="GetRecentMessageId__count">
        <![CDATA[
        select count(*) from FormMessages where RelatedFormGUID=:form and PostedAt=:PostedAt
        ]]>
    <query-param name="form" type="java.lang.String"/>
    <query-param name="PostedAt" type="java.sql.Timestamp"/>
    </query>

    <query name="getInspectionsByOutcome">
        <![CDATA[
        select 
inspectionGuid as inspectionGuid,
assignedTo as assignedTo,
inspectionOutcome.outcome as outcome,
inspectionTitle as inspectionTitle,
inspectionZone as inspectionZone,
requestedFor as requestedFor,
inspectionDesign.inspectDesignName as inspectDesignName

from MasterInspections where inspectionDesign.municipalities.id=:municipality and inspectionOutcome.outcome=:outcome and assignedTo is null
Order By inspectionZone DESC
        ]]>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="outcome" type="java.lang.String"/>
    </query>

    <query name="getCalculatableFormFields">
        <![CDATA[
        from FormTypeFields where formTypeId=:formTypeId and (formFieldTypes.label='Number' or formFieldTypes.label='Currency' or formFieldTypes.label='Calculated')
        ]]>
    <query-param name="formTypeId" type="java.lang.Integer"/>
    </query>

    <query name="getCalculatableFormFields__count">
        <![CDATA[
        select count(*) from FormTypeFields where formTypeId=:formTypeId and (formFieldTypes.label='Number' or formFieldTypes.label='Currency' or formFieldTypes.label='Calculated')
        ]]>
    <query-param name="formTypeId" type="java.lang.Integer"/>
    </query>

    <sql-query name="AdminsMunicipalities">
        <![CDATA[
        select M.* from Municipalities M,Roles R,Users U where U.ID=:user and U.ID=R.UserId and R.MunicipalityId=M.ID  and R.RoleName='MunicipalityAdmin'
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="AdminsMunicipalities__count">
        <![CDATA[
        select count(*) from (select M.* from Municipalities M,Roles R,Users U where U.ID=:user and U.ID=R.UserId and R.MunicipalityId=M.ID  and R.RoleName='MunicipalityAdmin') wmTempTable
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="InsertIntoCart">
        <![CDATA[
        insert into MyCart(FeeId,UserId) values(:FeeId,:UserId)
        ]]>
    <query-param name="FeeId" type="java.lang.Integer"/>
    <query-param name="UserId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="ProjectSoftDelete">
        <![CDATA[
        update Projects set Active=:active where ProjectGuid=:ProjectGuid
        ]]>
    <query-param name="active" type="java.lang.Boolean"/>
    <query-param name="ProjectGuid" type="java.lang.String"/>
    </sql-query>

    <sql-query name="UpdatePrimaryVendorInMasterForms">
        <![CDATA[
        Update MasterForms set CXVendorId=:VendorId where FormGUID=:FormGUID
        ]]>
    <query-param name="VendorId" type="java.lang.Integer"/>
    <query-param name="FormGUID" type="java.lang.String"/>
    </sql-query>

    <sql-query name="StandardUserMunicipalites">
        <![CDATA[
        select M.* from Municipalities M,UserSubscriptions US,Users U where U.ID=:USER and U.ID=US.UserId and US.MunicipalityId=M.ID ORDER BY M.MunicipalityName ASC
        ]]>
    <query-param name="USER" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="getEmailId">
        <![CDATA[
        select Email from Users where ID =:userID
        ]]>
    <query-param name="userID" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="getEmailId__count">
        <![CDATA[
        select count(*) from (select Email from Users where ID =:userID) wmTempTable
        ]]>
    <query-param name="userID" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="AddUsersToVendor">
        <![CDATA[
        insert into  VendorUsers(VendorId,UserId,JoiningDate) values(:VendorId,:UserId,:JoiningDate)
        ]]>
    <query-param name="VendorId" type="java.lang.Integer"/>
    <query-param name="UserId" type="java.lang.Integer"/>
    <query-param name="JoiningDate" type="java.sql.Date"/>
    </sql-query>

    <sql-query name="UpdatePasswordAndCF">
        <![CDATA[
        UPDATE Users SET Password=:password, CommunicationFrequency=:cf where ID=:newUser
        ]]>
    <query-param name="password" type="java.lang.String"/>
    <query-param name="cf" type="java.lang.String"/>
    <query-param name="newUser" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CheckingUserWithMunicipalityInRoles">
        <![CDATA[
        select count(*) as exist from Roles where MunicipalityId=:muncipality and UserId=:user and RoleName='MunicipalityEmployee'
        ]]>
    <query-param name="muncipality" type="java.lang.Integer"/>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CheckingUserWithMunicipalityInRoles__count">
        <![CDATA[
        select count(*) from (select count(*) as exist from Roles where MunicipalityId=:muncipality and UserId=:user and RoleName='MunicipalityEmployee') wmTempTable
        ]]>
    <query-param name="muncipality" type="java.lang.Integer"/>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="UpdateCFInProfile">
        <![CDATA[
        Update Users set CommunicationFrequency=:cf where ID=:user
        ]]>
    <query-param name="cf" type="java.lang.String"/>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="MunicipalitiesGroupsCounts">
        <![CDATA[
        select count(*) as groupsCount from MunicipalityGroups where MunicipalityId=:municipality
        ]]>
    <query-param name="municipality" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="MunicipalitiesGroupsCounts__count">
        <![CDATA[
        select count(*) from (select count(*) as groupsCount from MunicipalityGroups where MunicipalityId=:municipality) wmTempTable
        ]]>
    <query-param name="municipality" type="java.lang.Integer"/>
    </sql-query>

    <query name="GetRecentMessageIdForProject">
        <![CDATA[
        from FormMessages where RelatedProjectGUID=:project and postedAt=:PostedAt
        ]]>
    <query-param name="project" type="java.lang.String"/>
    <query-param name="PostedAt" type="java.sql.Timestamp"/>
    </query>

    <query name="GetRecentMessageIdForProject__count">
        <![CDATA[
        select count(*) from FormMessages where RelatedProjectGUID=:project and postedAt=:PostedAt
        ]]>
    <query-param name="project" type="java.lang.String"/>
    <query-param name="PostedAt" type="java.sql.Timestamp"/>
    </query>

    <sql-query name="InsertCategoryMapping">
        <![CDATA[
        insert into FormCategoryMapping(FormTypeId,FormCategoryId) values(:FormTypeId,:FormCategoryId)
        ]]>
    <query-param name="FormTypeId" type="java.lang.Integer"/>
    <query-param name="FormCategoryId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="ProcessFormsForUserByMunicipality">
        <![CDATA[
        SELECT MF.FormGuid as formGuid,
	MF.FormTitle as formTitle,
	MU.MunicipalityName as municipalityName,
	U.FullName as createdBy,
	FT.FormType as formDesign,
	FS.Status as formStatus,
	GR.Lot as lot,
	GR.Subdivision as subdivision,
	GR.FullAddress as address,
	V.CompanyName as primaryVendor,
	MF.BalanceDue as balanceDue
FROM MasterForms MF
LEFT OUTER JOIN FormStatuses AS FS ON FS.ID=MF.FormStatusId
LEFT OUTER JOIN FormTypes AS FT ON FT.ID=MF.FormTypeId
LEFT OUTER JOIN Municipalities AS MU ON MU.ID=FT.MunicipalityId
LEFT JOIN Users AS U ON U.ID=MF.UserId
LEFT JOIN MunicipalityGroups AS MG ON MG.id=FS.processOwners
LEFT OUTER JOIN Vendor AS V ON V.ID=MF.CXVendorId
LEFT OUTER JOIN (SELECT ROW_NUMBER() OVER (PARTITION BY GF.RelatedFormGUID ORDER BY GF.AddedTime) AS rn,
				GF.RelatedFormGuid as formGuid,
				GR.Lot,
				SD.Subdivision,
				GR.FullAddress
				FROM GIS2Forms GF, GisRecords GR, Subdivisions SD
				WHERE GR.ID=GF.GISRecordId AND SD.ID=GR.SubdivisionId
) AS GR ON GR.FormGuid=MF.FormGUID AND GR.rn=1
where
    Closed=:closed
    AND FT.MunicipalityId=:MunicipalityId
	AND :UserId IN (SELECT GM.userId FROM MunicipalityGroupMembers GM WHERE GM.municipalityGroupId=MG.id)
ORDER BY DateModified DESC
        ]]>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="MunicipalityId" type="java.lang.Long"/>
    <query-param name="UserId" type="java.lang.Long"/>
    </sql-query>

    <sql-query name="FormsCountForMunicipalities">
        <![CDATA[
        select count(*) as formsCount from MasterForms where MunicipalityId=:MunicipalityId
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="FormsCountForMunicipalities__count">
        <![CDATA[
        select count(*) from (select count(*) as formsCount from MasterForms where MunicipalityId=:MunicipalityId) wmTempTable
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfMunicipalityProjects">
        <![CDATA[
        select count(*) as count from Projects where MunicipalityId=:municipalityId and Active=:Active
        ]]>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="Active" type="java.lang.Boolean"/>
    </sql-query>

    <sql-query name="CountOfMunicipalityProjects__count">
        <![CDATA[
        select count(*) from (select count(*) as count from Projects where MunicipalityId=:municipalityId and Active=:Active) wmTempTable
        ]]>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="Active" type="java.lang.Boolean"/>
    </sql-query>

    <sql-query name="VendorCount">
        <![CDATA[
        select count(*) as VendorCount from Vendor
        ]]>
    </sql-query>

    <sql-query name="VendorCount__count">
        <![CDATA[
        select count(*) from (select count(*) as VendorCount from Vendor) wmTempTable
        ]]>
    </sql-query>

    <sql-query name="UpdateWorkMunicipality">
        <![CDATA[
        Update Municipalities set MondayYN=:monday,TuesdayYN=:tuesday,WednesdayYN=:wednesday,ThursdayYN=:thursday,FridayYN=:friday,SaturdayYN=:saturday,SundayYN=:sunday,TimeZone=:timezone,OpenTime=:openTime,CloseTime=:closeTime where ID=:municipalityId
        ]]>
    <query-param name="monday" type="java.lang.Boolean"/>
    <query-param name="tuesday" type="java.lang.Boolean"/>
    <query-param name="wednesday" type="java.lang.Boolean"/>
    <query-param name="thursday" type="java.lang.Boolean"/>
    <query-param name="friday" type="java.lang.Boolean"/>
    <query-param name="saturday" type="java.lang.Boolean"/>
    <query-param name="sunday" type="java.lang.Boolean"/>
    <query-param name="timezone" type="java.lang.String"/>
    <query-param name="openTime" type="java.sql.Time"/>
    <query-param name="closeTime" type="java.sql.Time"/>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="FeeByFeeTypesToDashboard">
        <![CDATA[
        select FeeType as Fee, count(ID) as counts from Fees 
where MunicipalityId=:municpality and PaidDate BETWEEN :startDate and :endDate
group by FeeType
        ]]>
    <query-param name="municpality" type="java.lang.Integer"/>
    <query-param name="startDate" type="java.sql.Date"/>
    <query-param name="endDate" type="java.sql.Date"/>
    </sql-query>

    <sql-query name="FeeByFeeTypesToDashboard__count">
        <![CDATA[
        select count(*) from (select FeeType as Fee, count(ID) as counts from Fees 
where MunicipalityId=:municpality and PaidDate BETWEEN :startDate and :endDate
group by FeeType) wmTempTable
        ]]>
    <query-param name="municpality" type="java.lang.Integer"/>
    <query-param name="startDate" type="java.sql.Date"/>
    <query-param name="endDate" type="java.sql.Date"/>
    </sql-query>

    <query name="getFormTypeFieldsByTypeId">
        <![CDATA[
        FROM FormTypeFields WHERE FormTypeId=:formTypeId order by DisplayOrder asc
        ]]>
    <query-param name="formTypeId" type="java.lang.Long"/>
    </query>

    <query name="getFormTypeFieldsByTypeId__count">
        <![CDATA[
        select count(*) FROM FormTypeFields WHERE FormTypeId=:formTypeId
        ]]>
    <query-param name="formTypeId" type="java.lang.Long"/>
    </query>

    <sql-query name="CountOfProjectsForUsersAndSharedWithByMunicipality">
        <![CDATA[
        select count(*) as count from Projects where MunicipalityId=:municipalityId and Active=:Active and (CreatedBy=:creatorUser or ProjectGUID IN (select RelatedProjectGUID from  ProjectSharedWith where ProjectSharedWithUser = :sharedWithUser ))
        ]]>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="Active" type="java.lang.Boolean"/>
    <query-param name="creatorUser" type="java.lang.Integer"/>
    <query-param name="sharedWithUser" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfProjectsForUsersAndSharedWithByMunicipality__count">
        <![CDATA[
        select count(*) from (select count(*) as count from Projects where MunicipalityId=:municipalityId and Active=:Active and (CreatedBy=:creatorUser or ProjectGUID IN (select RelatedProjectGUID from  ProjectSharedWith where ProjectSharedWithUser = :sharedWithUser ))) wmTempTable
        ]]>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="Active" type="java.lang.Boolean"/>
    <query-param name="creatorUser" type="java.lang.Integer"/>
    <query-param name="sharedWithUser" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="UpdateConsiderClosedForInspectionOutcome">
        <![CDATA[
        update InspectionOutcome set ConsiderClosed=:ConsiderClosed where ID=:id
        ]]>
    <query-param name="ConsiderClosed" type="java.lang.Boolean"/>
    <query-param name="id" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="UpdateAsCXVendorAdmin">
        <![CDATA[
        update Roles set roleName=:role,MunicipalityId=:municipality where UserId=:user
        ]]>
    <query-param name="role" type="java.lang.String"/>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="FormsByCategory">
        <![CDATA[
        select FT.* from FormTypes FT,FormCategoryMapping FM,FormCategories FC where FC.ID=:formCategory and FC.ID=FM.FormCategoryId and FM.FormTypeId=FT.ID and FT.Active=:isActive and FT.MunicipalityInternalForm=0
        ]]>
    <query-param name="formCategory" type="java.lang.Integer"/>
    <query-param name="isActive" type="java.lang.Boolean"/>
    </sql-query>

    <sql-query name="FormsByCategory__count">
        <![CDATA[
        select count(*) from (select FT.* from FormTypes FT,FormCategoryMapping FM,FormCategories FC where FC.ID=:formCategory and FC.ID=FM.FormCategoryId and FM.FormTypeId=FT.ID and FT.Active=:isActive and FT.MunicipalityInternalForm=0) wmTempTable
        ]]>
    <query-param name="formCategory" type="java.lang.Integer"/>
    <query-param name="isActive" type="java.lang.Boolean"/>
    </sql-query>

    <sql-query name="CountOfCompnayFormsByVendorId">
        <![CDATA[
        select count(*) as count from MasterForms where Closed=:closed and  FormGUID IN (select RelatedFormGUID from Vendors2Form where VendorId=:vendorId )
        ]]>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="vendorId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfCompnayFormsByVendorId__count">
        <![CDATA[
        select count(*) from (select count(*) as count from MasterForms where Closed=:closed and  FormGUID IN (select RelatedFormGUID from Vendors2Form where VendorId=:vendorId )) wmTempTable
        ]]>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="vendorId" type="java.lang.Integer"/>
    </sql-query>

    <query name="OpenedOrClosedFormsForUserOrSharedWith">
        <![CDATA[
        from MasterForms where UserId=:userId or FormGUID IN (select relatedGuid from  SharedWith where SharedWithUser = :userId) ORDER BY DateModified DESC
        ]]>
    <query-param name="userId" type="java.lang.Long"/>
    </query>

    <query name="OpenedOrClosedFormsForUserOrSharedWith__count">
        <![CDATA[
        select count(*) from MasterForms where UserId=:userId or FormGUID IN (select relatedGuid from  SharedWith where SharedWithUser = :userId)
        ]]>
    <query-param name="userId" type="java.lang.Long"/>
    </query>

    <sql-query name="searchUsersByEmailOrName">
        <![CDATA[
        SELECT ID, FullName, Photo, Email FROM Users WHERE Active=1 AND (Email LIKE CONCAT('%',:searchString,'%') OR FullName LIKE CONCAT('%',:searchString,'%'))
        ]]>
    <query-param name="searchString" type="java.lang.String"/>
    </sql-query>

    <sql-query name="searchUsersByEmailOrName__count">
        <![CDATA[
        select count(*) from (SELECT ID, FullName, Photo, Email FROM Users WHERE Active=1 AND (Email LIKE CONCAT('%',:searchString,'%') OR FullName LIKE CONCAT('%',:searchString,'%'))) wmTempTable
        ]]>
    <query-param name="searchString" type="java.lang.String"/>
    </sql-query>

    <sql-query name="UpdateGlobalEmailSig">
        <![CDATA[
        Update Municipalities set GlobalEmailSig=:gs where ID=:municipality
        ]]>
    <query-param name="gs" type="java.lang.String"/>
    <query-param name="municipality" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="DeleteFromVendorAdmins">
        <![CDATA[
        delete from VendorAdmins where UserId=:user and VendorId=:vendor
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="SetPrimaryVendorStatusForFormandVendor">
        <![CDATA[
        update Vendors2Form set PrimaryVendor=:pv where RelatedFormGUID=:form and VendorID=:vendor
        ]]>
    <query-param name="pv" type="java.lang.Boolean"/>
    <query-param name="form" type="java.lang.String"/>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <query name="AllFeeformCount">
        <![CDATA[
        select 
count (*) as count
from Fees where  masterForms.formStatuses.allowPayment=:allowPayment  and paidStatus=:paidStatus  and formGuid IN 
       (select formGuid from MasterForms where userId=:userId or formGuid IN 
              (select relatedGuid from  SharedWith where sharedWithUser = :userId)
        )
        ]]>
    <query-param name="allowPayment" type="java.lang.Boolean"/>
    <query-param name="paidStatus" type="java.lang.String"/>
    <query-param name="userId" type="java.lang.Integer"/>
    </query>

    <query name="AllFeeformCount__count">
        <![CDATA[
        select count(*)  from MasterForms where userId=:userId or formGuid IN 
              (select relatedGuid from  SharedWith where sharedWithUser = :userId)
        )
        ]]>
    <query-param name="allowPayment" type="java.lang.Boolean"/>
    <query-param name="paidStatus" type="java.lang.String"/>
    <query-param name="userId" type="java.lang.Integer"/>
    </query>

    <sql-query name="DeleteCategoryMapping">
        <![CDATA[
        delete from FormCategoryMapping where FormTypeId=:form
        ]]>
    <query-param name="form" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="getUserIdFromPasswordResetToken">
        <![CDATA[
        select UserId from UserPasswordResetTokens WHERE( ExpirationDate >= GETDATE() AND Token = :token)
        ]]>
    <query-param name="token" type="java.lang.String"/>
    </sql-query>

    <sql-query name="getUserIdFromPasswordResetToken__count">
        <![CDATA[
        select count(*) from (select UserId from UserPasswordResetTokens WHERE( ExpirationDate >= GETDATE() AND Token = :token)) wmTempTable
        ]]>
    <query-param name="token" type="java.lang.String"/>
    </sql-query>

    <sql-query name="FormsByVendorsForDashboard">
        <![CDATA[
        select V.companyName as vendorCompany ,count(MF.formGuid) as counts 
from MasterForms  MF inner join cx2.Vendor V
on MF.CXVendorId=V.ID where MF.MunicipalityId=:municipality and MF.DateSubmitted BETWEEN :startDate and :endDate
group by V.companyName
        ]]>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="startDate" type="java.sql.Timestamp"/>
    <query-param name="endDate" type="java.sql.Timestamp"/>
    </sql-query>

    <sql-query name="FormsByVendorsForDashboard__count">
        <![CDATA[
        select count(*) from (select V.companyName as vendorCompany ,count(MF.formGuid) as counts 
from MasterForms  MF inner join cx2.Vendor V
on MF.CXVendorId=V.ID where MF.MunicipalityId=:municipality and MF.DateSubmitted BETWEEN :startDate and :endDate
group by V.companyName) wmTempTable
        ]]>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="startDate" type="java.sql.Timestamp"/>
    <query-param name="endDate" type="java.sql.Timestamp"/>
    </sql-query>

    <sql-query name="CountOfProcessFormsByMuncipality">
        <![CDATA[
        select count(*) as count from MasterForms MF, FormStatuses FS, MunicipalityGroups MG
    WHERE FS.id=MF.formStatusId
	and MG.id=FS.processOwners
	and MF.MunicipalityId=:MunicipalityId
	and MF.closed=:closed
	and :UserId IN (SELECT GM.userId FROM MunicipalityGroupMembers GM WHERE GM.municipalityGroupId=MG.id)
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="UserId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfProcessFormsByMuncipality__count">
        <![CDATA[
        select count(*) from (select count(*) as count from MasterForms MF, FormStatuses FS, MunicipalityGroups MG
    WHERE FS.id=MF.formStatusId
	and MG.id=FS.processOwners
	and MF.MunicipalityId=:MunicipalityId
	and MF.closed=:closed
	and :UserId IN (SELECT GM.userId FROM MunicipalityGroupMembers GM WHERE GM.municipalityGroupId=MG.id)) wmTempTable
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="UserId" type="java.lang.Integer"/>
    </sql-query>

    <query name="countAssignedInspectionsBetweenDates">
        <![CDATA[
        select 
count(*) as inspectionsCount

from MasterInspections where inspectionDesign.municipalities.id=:municipality and closed=:isClosed and assignedTo=:assignedTo and requestedFor between :startDate and :endDate
        ]]>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="isClosed" type="java.lang.Boolean"/>
    <query-param name="assignedTo" type="java.lang.Integer"/>
    <query-param name="startDate" type="org.joda.time.LocalDateTime"/>
    <query-param name="endDate" type="org.joda.time.LocalDateTime"/>
    </query>

    <sql-query name="UpdateVendorsToProject">
        <![CDATA[
        update  VendorsToProject set PrimaryVendor=:PrimaryVendor Where ProjectGuid=:project and VendorId=:vendor
        ]]>
    <query-param name="PrimaryVendor" type="java.lang.Boolean"/>
    <query-param name="project" type="java.lang.String"/>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="UpdateVendorsToProject__count">
        <![CDATA[
        select count(*) from (update  VendorsToProject set PrimaryVendor=:PrimaryVendor Where ProjectGuid=:project and VendorId=:vendor) wmTempTable
        ]]>
    <query-param name="PrimaryVendor" type="java.lang.Boolean"/>
    <query-param name="project" type="java.lang.String"/>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfCXProjectsActive">
        <![CDATA[
        select count(*) as count from Projects where active='true'
        ]]>
    </sql-query>

    <sql-query name="CountOfCXProjectsActive__count">
        <![CDATA[
        select count(*) from (select count(*) as count from Projects where active='true') wmTempTable
        ]]>
    </sql-query>

    <query name="distinctInspectionDesignsForFormType">
        <![CDATA[
        select DISTINCT inspectDesignId as inspectionDesignId,inspectionDesign.inspectDesignName as inspectDesignName,inspectionDesign.allowSameDayInspections as allowSameDayInspections,inspectionDesign. maxDaysInAdvance as maxDaysInAdvance,sequenceOrderNumber as sequenceOrderNumber,mustCompBeforeReqNxt as mustCompBeforeReqNxt from InspectionSequence
where formTypeId=:form order by sequenceOrderNumber asc
        ]]>
    <query-param name="form" type="java.lang.Integer"/>
    </query>

    <query name="distinctInspectionDesignsForFormType__count">
        <![CDATA[
        select count(*)  from InspectionSequence
where formTypeId=:form
        ]]>
    <query-param name="form" type="java.lang.Integer"/>
    </query>

    <query name="InspectionsOfForm">
        <![CDATA[
        from FormsToInspections where RelatedFormGUID=:form
        ]]>
    <query-param name="form" type="java.lang.String"/>
    </query>

    <sql-query name="AddingVendorsToForm">
        <![CDATA[
        insert into Vendors2Form(RelatedFormGUID,SharedOn,VendorId) values(:RelatedFormGUID,:SharedOn,:VendorId)
        ]]>
    <query-param name="RelatedFormGUID" type="java.lang.String"/>
    <query-param name="SharedOn" type="java.sql.Timestamp"/>
    <query-param name="VendorId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="getCartItemIds">
        <![CDATA[
        select ID, FeeId as feeId from MyCart where UserId=:userId
        ]]>
    <query-param name="userId" type="java.lang.Long"/>
    </sql-query>

    <sql-query name="getCartItemIds__count">
        <![CDATA[
        select count(*) from (select ID, FeeId as feeId from MyCart where UserId=:userId) wmTempTable
        ]]>
    <query-param name="userId" type="java.lang.Long"/>
    </sql-query>

    <query name="PreferenceForUser">
        <![CDATA[
        from StandardViews where id IN (select preferenceId from  UserViewPreferences where userId = :userId )
        ]]>
    <query-param name="userId" type="java.lang.Integer"/>
    </query>

    <query name="PreferenceForUser__count">
        <![CDATA[
        select count(*) from StandardViews where id IN (select preferenceId from  UserViewPreferences where userId = :userId )
        ]]>
    <query-param name="userId" type="java.lang.Integer"/>
    </query>

    <sql-query name="InsertMasterInspections">
        <![CDATA[
        insert into MasterInspections(InspectionGuid,InspectionTitle,InspectionDesignId,FormGuid,RequestedBy,DateRequested,RequestedFor)
 values(:InspectionGuid,:InspectionTitle,:InspectionDesignId,:FormGuid,:RequestedBy,:DateRequested,:RequestedFor)
        ]]>
    <query-param name="InspectionGuid" type="java.lang.String"/>
    <query-param name="InspectionTitle" type="java.lang.String"/>
    <query-param name="InspectionDesignId" type="java.lang.Integer"/>
    <query-param name="FormGuid" type="java.lang.String"/>
    <query-param name="RequestedBy" type="java.lang.Integer"/>
    <query-param name="DateRequested" type="org.joda.time.LocalDateTime"/>
    <query-param name="RequestedFor" type="org.joda.time.LocalDateTime"/>
    </sql-query>

    <sql-query name="UserCount">
        <![CDATA[
        select count(*) as usersCount from Users
        ]]>
    </sql-query>

    <sql-query name="UserCount__count">
        <![CDATA[
        select count(*) from (select count(*) as usersCount from Users) wmTempTable
        ]]>
    </sql-query>

    <query name="FeesInCartByUser">
        <![CDATA[
        from MyCart where userId=:user and fees.paidStatus='Unpaid'
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    </query>

    <query name="FeesInCartByUser__count">
        <![CDATA[
        select count(*) from MyCart where userId=:user and fees.paidStatus='Unpaid'
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    </query>

    <sql-query name="NoOfItemsInUserCart">
        <![CDATA[
        select count(*) as count from MyCart where UserId=:user
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="NoOfItemsInUserCart__count">
        <![CDATA[
        select count(*) from (select count(*) as count from MyCart where UserId=:user) wmTempTable
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CheckIfCompanyUserIsVendorAdmin">
        <![CDATA[
        select count(*) as count from VendorAdmins where UserId=:user and VendorId=:vendor
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CheckIfCompanyUserIsVendorAdmin__count">
        <![CDATA[
        select count(*) from (select count(*) as count from VendorAdmins where UserId=:user and VendorId=:vendor) wmTempTable
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <query name="AllFeesOfFormsForCreatedByAndSharedWithByMunicipality">
        <![CDATA[
        select 
id as feeId,
masterForms.formGuid as formGuid,
masterForms.formTitle as formTitle,
masterForms.formTypes.formType as FormType,
masterForms.formTypes.municipalities.municipalityName as municipality,
masterForms.giscontacts.gisrecords.fullAddress as address,
feeType as feeType,
amount as amount
from Fees where masterForms.formStatuses.allowPayment=:allowPayment and municipalityId=:municipalityId and paidStatus=:paidStatus and formGuid IN 
       (select formGuid from MasterForms where userId=:userId or formGuid IN 
              (select relatedGuid from  SharedWith where sharedWithUser = :userId)
        )
        ]]>
    <query-param name="allowPayment" type="java.lang.Boolean"/>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="paidStatus" type="java.lang.String"/>
    <query-param name="userId" type="java.lang.Integer"/>
    </query>

    <query name="AllFeesOfFormsForCreatedByAndSharedWithByMunicipality__count">
        <![CDATA[
        select count(*)  from MasterForms where userId=:userId or formGuid IN 
              (select relatedGuid from  SharedWith where sharedWithUser = :userId)
        )
        ]]>
    <query-param name="allowPayment" type="java.lang.Boolean"/>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="paidStatus" type="java.lang.String"/>
    <query-param name="userId" type="java.lang.Integer"/>
    </query>

    <sql-query name="UpdateProjectDetails">
        <![CDATA[
        Update Projects set ProjectName=:ProjectName,ProjectGoals=:ProjectGoals,EstStartDate=:EstStartDate,EstEndDate=:EstEndDate where ProjectGUID=:project
        ]]>
    <query-param name="ProjectName" type="java.lang.String"/>
    <query-param name="ProjectGoals" type="java.lang.String"/>
    <query-param name="EstStartDate" type="java.sql.Timestamp"/>
    <query-param name="EstEndDate" type="java.sql.Timestamp"/>
    <query-param name="project" type="java.lang.String"/>
    </sql-query>

    <sql-query name="InsertUserPreference">
        <![CDATA[
        insert into UserViewPreferences(UserId,PreferenceId) values(:UserId,:PreferenceId)
        ]]>
    <query-param name="UserId" type="java.lang.Integer"/>
    <query-param name="PreferenceId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfMuncipalityApplicationsByVendor">
        <![CDATA[
        select count(*) as count from VendorApprovals where VendorId=:VendorId
        ]]>
    <query-param name="VendorId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfMuncipalityApplicationsByVendor__count">
        <![CDATA[
        select count(*) from (select count(*) as count from VendorApprovals where VendorId=:VendorId) wmTempTable
        ]]>
    <query-param name="VendorId" type="java.lang.Integer"/>
    </sql-query>

    <query name="AllFeeFormCountByMunicipality">
        <![CDATA[
        select 
count (*) as count
from Fees where  masterForms.formStatuses.allowPayment=:allowPayment  and paidStatus=:paidStatus and  municipalityId=:municipalityId and formGuid IN 
       (select formGuid from MasterForms where userId=:userId or formGuid IN 
              (select relatedGuid from  SharedWith where sharedWithUser = :userId)
        )
        ]]>
    <query-param name="allowPayment" type="java.lang.Boolean"/>
    <query-param name="paidStatus" type="java.lang.String"/>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="userId" type="java.lang.Integer"/>
    </query>

    <query name="AllFeeFormCountByMunicipality__count">
        <![CDATA[
        select count(*)  from MasterForms where userId=:userId or formGuid IN 
              (select relatedGuid from  SharedWith where sharedWithUser = :userId)
        )
        ]]>
    <query-param name="allowPayment" type="java.lang.Boolean"/>
    <query-param name="paidStatus" type="java.lang.String"/>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="userId" type="java.lang.Integer"/>
    </query>

    <sql-query name="userSubscriptionsCountForMunicipality">
        <![CDATA[
        select count(*) as userSubscriptionsCountForMunicipality from UserSubscriptions where MunicipalityId=:municipalityId
        ]]>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="userSubscriptionsCountForMunicipality__count">
        <![CDATA[
        select count(*) from (select count(*) as userSubscriptionsCountForMunicipality from UserSubscriptions where MunicipalityId=:municipalityId) wmTempTable
        ]]>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="UpdateFeesStatus">
        <![CDATA[
        update Fees set PaidStatus=:status where ID=:feeEntry
        ]]>
    <query-param name="status" type="java.lang.String"/>
    <query-param name="feeEntry" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="AddUserToMunicipalityGroup">
        <![CDATA[
        insert into MunicipalityGroupMembers(MunicipalityGroupId,UserId) values(:MunicipalityGroupId,:UserId)
        ]]>
    <query-param name="MunicipalityGroupId" type="java.lang.Integer"/>
    <query-param name="UserId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="AddGIStoProjects">
        <![CDATA[
        insert into ProjectGISRecords(GISRecordId,RelatedProjectGUID,AddedByUser,AddedAt) values(:GISRecordId,:RelatedProjectGUID,:AddedByUser,:AddedAt)
        ]]>
    <query-param name="GISRecordId" type="java.lang.Integer"/>
    <query-param name="RelatedProjectGUID" type="java.lang.String"/>
    <query-param name="AddedByUser" type="java.lang.Integer"/>
    <query-param name="AddedAt" type="java.sql.Timestamp"/>
    </sql-query>

    <sql-query name="CountOfUserForms">
        <![CDATA[
        select count(*) as count from MasterForms where Closed=:closed and (UserId=:creatorUser or FormGUID IN (select RelatedGUID from  SharedWith where SharedWithUser = :sharedWithUser ))
        ]]>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="creatorUser" type="java.lang.Integer"/>
    <query-param name="sharedWithUser" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfUserForms__count">
        <![CDATA[
        select count(*) from (select count(*) as count from MasterForms where Closed=:closed and (UserId=:creatorUser or FormGUID IN (select RelatedGUID from  SharedWith where SharedWithUser = :sharedWithUser ))) wmTempTable
        ]]>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="creatorUser" type="java.lang.Integer"/>
    <query-param name="sharedWithUser" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfFormsForMunicipality">
        <![CDATA[
        select count(DISTINCT ID) as count from FormTypes where MunicipalityId=:MunicipalityId
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfFormsForMunicipality__count">
        <![CDATA[
        select count(*) from (select count(DISTINCT ID) as count from FormTypes where MunicipalityId=:MunicipalityId) wmTempTable
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="DeleteDraft">
        <![CDATA[
        delete from FormDraft where id=:draftId
        ]]>
    <query-param name="draftId" type="java.lang.Long"/>
    </sql-query>

    <sql-query name="UpdateDevFormDetailsForCXAdmin">
        <![CDATA[
        UPDATE FormTypes set Report=:Report, FormTableName=:FormTableName where ID=:form
        ]]>
    <query-param name="Report" type="java.lang.String"/>
    <query-param name="FormTableName" type="java.lang.String"/>
    <query-param name="form" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="UpdateVendorForMasterForms">
        <![CDATA[
        update MasterForms set CXVendorId=:CXVendorId where FormGUID=:FormGUID
        ]]>
    <query-param name="CXVendorId" type="java.lang.Integer"/>
    <query-param name="FormGUID" type="java.lang.String"/>
    </sql-query>

    <sql-query name="EmployeesOrAdminsMunicipalities">
        <![CDATA[
        select M.* from Municipalities M,Roles R,Users U where U.ID=:user and U.ID=R.UserId and R.MunicipalityId=M.ID and R.RoleName=:role
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    <query-param name="role" type="java.lang.String"/>
    </sql-query>

    <sql-query name="EmployeesOrAdminsMunicipalities__count">
        <![CDATA[
        select count(*) from (select M.* from Municipalities M,Roles R,Users U where U.ID=:user and U.ID=R.UserId and R.MunicipalityId=M.ID and R.RoleName=:role) wmTempTable
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    <query-param name="role" type="java.lang.String"/>
    </sql-query>

    <sql-query name="UpdateForceInspectionSequenceForForm">
        <![CDATA[
        update FormTypes set ForceInspectionSequence=:ForceInspectionSequence where ID=:form
        ]]>
    <query-param name="ForceInspectionSequence" type="java.lang.Boolean"/>
    <query-param name="form" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfVendors">
        <![CDATA[
        select count(*) as CountOfVendors from VendorAdmins where UserId=:vendor
        ]]>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfVendors__count">
        <![CDATA[
        select count(*) from (select count(*) as CountOfVendors from VendorAdmins where UserId=:vendor) wmTempTable
        ]]>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="UpdateMunicipalityInfo">
        <![CDATA[
        Update Municipalities set MunicipalityName=:mn,Email=:em,Phone=:ph,Address1=:ad1,Address2=:ad2,StateId=:st,City=:ct,PostalCode=:pc where ID=:municipality
        ]]>
    <query-param name="mn" type="java.lang.String"/>
    <query-param name="em" type="java.lang.String"/>
    <query-param name="ph" type="java.lang.String"/>
    <query-param name="ad1" type="java.lang.String"/>
    <query-param name="ad2" type="java.lang.String"/>
    <query-param name="st" type="java.lang.Integer"/>
    <query-param name="ct" type="java.lang.String"/>
    <query-param name="pc" type="java.lang.String"/>
    <query-param name="municipality" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfUserFormsForMunicipality">
        <![CDATA[
        select count(*) as count from MasterForms where MunicipalityId=:MunicipalityId and Closed=:closed and (UserId=:creatorUser or FormGUID IN (select RelatedGUID from  SharedWith where SharedWithUser = :sharedWithUser ))
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="creatorUser" type="java.lang.Integer"/>
    <query-param name="sharedWithUser" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfUserFormsForMunicipality__count">
        <![CDATA[
        select count(*) from (select count(*) as count from MasterForms where MunicipalityId=:MunicipalityId and Closed=:closed and (UserId=:creatorUser or FormGUID IN (select RelatedGUID from  SharedWith where SharedWithUser = :sharedWithUser ))) wmTempTable
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="creatorUser" type="java.lang.Integer"/>
    <query-param name="sharedWithUser" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="deleteToken">
        <![CDATA[
        delete from UserPasswordResetTokens where Token =:token
        ]]>
    <query-param name="token" type="java.lang.String"/>
    </sql-query>

    <sql-query name="CountOfAllProjectsForUsersAndSharedWith">
        <![CDATA[
        select count(*) as count from Projects where  Active=:Active and (CreatedBy=:creatorUser or ProjectGUID IN (select RelatedProjectGUID from  ProjectSharedWith where ProjectSharedWithUser = :sharedWithUser ))
        ]]>
    <query-param name="Active" type="java.lang.Boolean"/>
    <query-param name="creatorUser" type="java.lang.Integer"/>
    <query-param name="sharedWithUser" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfAllProjectsForUsersAndSharedWith__count">
        <![CDATA[
        select count(*) from (select count(*) as count from Projects where  Active=:Active and (CreatedBy=:creatorUser or ProjectGUID IN (select RelatedProjectGUID from  ProjectSharedWith where ProjectSharedWithUser = :sharedWithUser ))) wmTempTable
        ]]>
    <query-param name="Active" type="java.lang.Boolean"/>
    <query-param name="creatorUser" type="java.lang.Integer"/>
    <query-param name="sharedWithUser" type="java.lang.Integer"/>
    </sql-query>

    <query name="assignedInspectionsLessThanDate">
        <![CDATA[
        select 
inspectionGuid as inspectionGuid,
assignedTo as assignedTo,
usersByAssignedTo.fullName as assignedToPersonName,
inspectionOutcome.outcome as outcome,
inspectionTitle as inspectionTitle,
inspectionZone as inspectionZone,
requestedFor as requestedFor,
gisrecords.fullAddress as fullAddress,
gisrecords.lot as lot,
gisrecords.subdivisions.subdivision as subdivision,
usersByRequestedBy.fullName as fullName,
inspectionDesign.inspectDesignName as inspectDesignName

from MasterInspections where inspectionDesign.municipalities.id=:municipality and closed=:isClosed and assignedTo=:assignedTo and requestedFor<:requestedFor
        ]]>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="isClosed" type="java.lang.Boolean"/>
    <query-param name="assignedTo" type="java.lang.Integer"/>
    <query-param name="requestedFor" type="org.joda.time.LocalDateTime"/>
    </query>

    <sql-query name="InsertTagForMessage">
        <![CDATA[
        Insert into FormMessageTagging(FormMessageId,TaggedPersonId) values(:FormMessageId,:TaggedPersonId)
        ]]>
    <query-param name="FormMessageId" type="java.lang.Integer"/>
    <query-param name="TaggedPersonId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="ManualFeeTypeCountForMunicipality">
        <![CDATA[
        Select count(*) as count from ManualFeeTypes where MunicipalityId=:MunicipalityId
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="ManualFeeTypeCountForMunicipality__count">
        <![CDATA[
        select count(*) from (Select count(*) as count from ManualFeeTypes where MunicipalityId=:MunicipalityId) wmTempTable
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <query name="assignedInspectionsBetweenDates">
        <![CDATA[
        select 
inspectionGuid as inspectionGuid,
assignedTo as assignedTo,
usersByAssignedTo.fullName as assignedToPersonName,
inspectionOutcome.outcome as outcome,
inspectionTitle as inspectionTitle,
inspectionZone as inspectionZone,
requestedFor as requestedFor,
gisrecords.fullAddress as fullAddress,
gisrecords.lot as lot,
gisrecords.subdivisions.subdivision as subdivision,
usersByRequestedBy.fullName as fullName,
inspectionDesign.inspectDesignName as inspectDesignName

from MasterInspections where inspectionDesign.municipalities.id=:municipality and closed=:isClosed and assignedTo=:assignedTo and requestedFor between :startDate and :endDate
        ]]>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="isClosed" type="java.lang.Boolean"/>
    <query-param name="assignedTo" type="java.lang.Integer"/>
    <query-param name="startDate" type="org.joda.time.LocalDateTime"/>
    <query-param name="endDate" type="org.joda.time.LocalDateTime"/>
    </query>

    <sql-query name="InsertSubscription">
        <![CDATA[
        insert into UserSubscriptions(UserId,MunicipalityId,DateSubscribed) values(:UserId,:MunicipalityId,:DateSubscribed)
        ]]>
    <query-param name="UserId" type="java.lang.Integer"/>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    <query-param name="DateSubscribed" type="java.lang.String"/>
    </sql-query>

    <sql-query name="GetProcessGroupMemebersByFormGUID">
        <![CDATA[
        select CASE count(*) WHEN 0 THEN 0 ELSE 1 END AS IsProcessOwner from MasterForms MF, FormStatuses FS, MunicipalityGroups MG
    WHERE MF.FormGUID=:FormGUID
    and FS.ID=MF.formStatusId
	and MG.ID=FS.processOwners
	and :UserId IN (SELECT GM.userId FROM MunicipalityGroupMembers GM WHERE GM.municipalityGroupId=MG.id)
        ]]>
    <query-param name="FormGUID" type="java.lang.String"/>
    <query-param name="UserId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="GetProcessGroupMemebersByFormGUID__count">
        <![CDATA[
        select count(*) from (select CASE count(*) WHEN 0 THEN 0 ELSE 1 END AS IsProcessOwner from MasterForms MF, FormStatuses FS, MunicipalityGroups MG
    WHERE MF.FormGUID=:FormGUID
    and FS.ID=MF.formStatusId
	and MG.ID=FS.processOwners
	and :UserId IN (SELECT GM.userId FROM MunicipalityGroupMembers GM WHERE GM.municipalityGroupId=MG.id)) wmTempTable
        ]]>
    <query-param name="FormGUID" type="java.lang.String"/>
    <query-param name="UserId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="AdminVendorsList">
        <![CDATA[
        select V.* from Vendor V,VendorAdmins VM,Users U where U.ID=:user and VM.UserId=U.ID and VM.VendorId=V.ID
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="AdminVendorsList__count">
        <![CDATA[
        select count(*) from (select V.* from Vendor V,VendorAdmins VM,Users U where U.ID=:user and VM.UserId=U.ID and VM.VendorId=V.ID) wmTempTable
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="GetFormTypesByCategoriesAndMunicipalities">
        <![CDATA[
        select FT.* from FormTypes FT, FormCategoryMapping FM 
WHERE ((:formCategory IS NULL AND FT.MunicipalityId=:municipalityId) OR (:formCategory IS NOT NULL AND FM.FormCategoryId=:formCategory))
and FM.FormTypeId=FT.ID
and FT.Active=1
and (FT.MunicipalityInternalForm=0
		OR EXISTS (SELECT RoleName from Roles where
					UserId=:userId
					and (MunicipalityId=FT.MunicipalityId and (RoleName='MunicipalityEmployee' or RoleName='MunicipalityAdmin')) or RoleName='CXAdmin'))
        ]]>
    <query-param name="formCategory" type="java.lang.Integer"/>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="userId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="GetFormTypesByCategoriesAndMunicipalities__count">
        <![CDATA[
        select count(*) from (select FT.* from FormTypes FT, FormCategoryMapping FM 
WHERE ((:formCategory IS NULL AND FT.MunicipalityId=:municipalityId) OR (:formCategory IS NOT NULL AND FM.FormCategoryId=:formCategory))
and FM.FormTypeId=FT.ID
and FT.Active=1
and (FT.MunicipalityInternalForm=0
		OR EXISTS (SELECT RoleName from Roles where
					UserId=:userId
					and (MunicipalityId=FT.MunicipalityId and (RoleName='MunicipalityEmployee' or RoleName='MunicipalityAdmin')) or RoleName='CXAdmin'))) wmTempTable
        ]]>
    <query-param name="formCategory" type="java.lang.Integer"/>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="userId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="DeleteRoleForMuncipality">
        <![CDATA[
        delete from Roles where RoleName=:role and MunicipalityId=:municipality and UserId=:user
        ]]>
    <query-param name="role" type="java.lang.String"/>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <query name="GetMunicipalityEmployees">
        <![CDATA[
        from Users
where id IN (select userId from Roles where roleName=:RoleName and municipalityId=:municipalityId) and email like :email
        ]]>
    <query-param name="RoleName" type="java.lang.String"/>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="email" type="java.lang.String"/>
    </query>

    <query name="GetMunicipalityEmployees__count">
        <![CDATA[
        select count(*) from Users
where id IN (select userId from Roles where roleName=:RoleName and municipalityId=:municipalityId) and email like :email
        ]]>
    <query-param name="RoleName" type="java.lang.String"/>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="email" type="java.lang.String"/>
    </query>

    <sql-query name="MapAsAdminForVendor">
        <![CDATA[
        insert into VendorAdmins(UserId,VendorId) values(:UserId,:VendorId)
        ]]>
    <query-param name="UserId" type="java.lang.Integer"/>
    <query-param name="VendorId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfInspectionDesignByMunicipality">
        <![CDATA[
        select count(*) as count from InspectionDesign where MunicipalityId=:MunicipalityId
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfInspectionDesignByMunicipality__count">
        <![CDATA[
        select count(*) from (select count(*) as count from InspectionDesign where MunicipalityId=:MunicipalityId) wmTempTable
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="InsertFormsIntoProject">
        <![CDATA[
        insert into ProjectForms(RelatedProjectGuid,RelatedFormGUID,AddedByUser,AddedAt,Comments) values(:RelatedProjectGuid,:RelatedFormGUID,:AddedByUser,:AddedAt,:Comments)
        ]]>
    <query-param name="RelatedProjectGuid" type="java.lang.String"/>
    <query-param name="RelatedFormGUID" type="java.lang.String"/>
    <query-param name="AddedByUser" type="java.lang.Integer"/>
    <query-param name="AddedAt" type="java.sql.Timestamp"/>
    <query-param name="Comments" type="java.lang.String"/>
    </sql-query>

    <sql-query name="RecordFormHistory">
        <![CDATA[
        insert into FormHistory(FormGUID,FormTypeId,NewStatusId,OldStatusId,Comments,CreatedBy,CreatedTime) values(:FormGUID,:FormTypeId,:NewStatusId,:OldStatusId,:Comments,:CreatedBy,SYSUTCDATETIME())
        ]]>
    <query-param name="FormGUID" type="java.lang.String"/>
    <query-param name="FormTypeId" type="java.lang.Integer"/>
    <query-param name="NewStatusId" type="java.lang.Integer"/>
    <query-param name="OldStatusId" type="java.lang.Integer"/>
    <query-param name="Comments" type="java.lang.String"/>
    <query-param name="CreatedBy" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="GetWriteAccessGroupMembersByFormGUID">
        <![CDATA[
        select MGM.*,MG.GroupName from MunicipalityGroupMembers MGM,MunicipalityGroups MG, MasterForms MF,FormStatuses FS where  MF.FormGUID=:FormGUID and MF.FormStatusId=FS.ID and FS.WriteAccess=MG.ID and MG.ID=MGM.MunicipalityGroupId
        ]]>
    <query-param name="FormGUID" type="java.lang.String"/>
    </sql-query>

    <sql-query name="GetWriteAccessGroupMembersByFormGUID__count">
        <![CDATA[
        select count(*) from (select MGM.*,MG.GroupName from MunicipalityGroupMembers MGM,MunicipalityGroups MG, MasterForms MF,FormStatuses FS where  MF.FormGUID=:FormGUID and MF.FormStatusId=FS.ID and FS.WriteAccess=MG.ID and MG.ID=MGM.MunicipalityGroupId) wmTempTable
        ]]>
    <query-param name="FormGUID" type="java.lang.String"/>
    </sql-query>

    <sql-query name="FormsByCategoryForDashBoard">
        <![CDATA[
        select count(MF.FormGUID) as counts,FC.Category
--MF.FormTypeId,MF.FormGUID,FT.ID,FT.FormType,FC.ID,FC.Category
from cx2.MasterForms MF 
inner join cx2.FormTypes FT
on  MF.FormTypeId=FT.ID
inner join  cx2.FormCategoryMapping FCM
on FCM.FormTypeId=FT.ID
inner join cx2.FormCategories FC
on FC.ID=FCM.FormCategoryId

where MF.MunicipalityId=:municipality and MF.DateSubmitted BETWEEN :startDate and :endDate
group by FC.Category
        ]]>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="startDate" type="java.sql.Timestamp"/>
    <query-param name="endDate" type="java.sql.Timestamp"/>
    </sql-query>

    <sql-query name="FormsByCategoryForDashBoard__count">
        <![CDATA[
        select count(*) from (select count(MF.FormGUID) as counts,FC.Category
--MF.FormTypeId,MF.FormGUID,FT.ID,FT.FormType,FC.ID,FC.Category
from cx2.MasterForms MF 
inner join cx2.FormTypes FT
on  MF.FormTypeId=FT.ID
inner join  cx2.FormCategoryMapping FCM
on FCM.FormTypeId=FT.ID
inner join cx2.FormCategories FC
on FC.ID=FCM.FormCategoryId

where MF.MunicipalityId=:municipality and MF.DateSubmitted BETWEEN :startDate and :endDate
group by FC.Category) wmTempTable
        ]]>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="startDate" type="java.sql.Timestamp"/>
    <query-param name="endDate" type="java.sql.Timestamp"/>
    </sql-query>

    <sql-query name="EmployeesMunicipalities">
        <![CDATA[
        select M.* from Municipalities M,Roles R,Users U where U.ID=:user and U.ID=R.UserId and R.MunicipalityId=M.ID and R.RoleName='MunicipalityEmployee'
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="EmployeesMunicipalities__count">
        <![CDATA[
        select count(*) from (select M.* from Municipalities M,Roles R,Users U where U.ID=:user and U.ID=R.UserId and R.MunicipalityId=M.ID and R.RoleName='MunicipalityEmployee') wmTempTable
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="RemoveVendorFromMasterForms">
        <![CDATA[
        Update MasterForms set  CXVendorId=null where FormGUID=:hb
        ]]>
    <query-param name="hb" type="java.lang.String"/>
    </sql-query>

    <sql-query name="UpdateFormStatusInMasterForms">
        <![CDATA[
        Update MasterForms set FormStatusId=:formStatus, Closed=:closed where FormGUID=:FormGUID
        ]]>
    <query-param name="formStatus" type="java.lang.Integer"/>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="FormGUID" type="java.lang.String"/>
    </sql-query>

    <query name="ProjectForms">
        <![CDATA[
        from ProjectForms where RelatedProjectGUID=:project
        ]]>
    <query-param name="project" type="java.lang.String"/>
    </query>

    <query name="ProjectForms__count">
        <![CDATA[
        select count(*) from ProjectForms where RelatedProjectGUID=:project
        ]]>
    <query-param name="project" type="java.lang.String"/>
    </query>

    <sql-query name="GetFeeIdsOfUserInCart">
        <![CDATA[
        select FeeId as id from MyCart where UserId=:user
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="GetFeeIdsOfUserInCart__count">
        <![CDATA[
        select count(*) from (select FeeId as id from MyCart where UserId=:user) wmTempTable
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfCasesForMunicipality">
        <![CDATA[
        select count(DISTINCT ID) as count from CaseTypes where MunicipalityId=:MunicipalityId
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfCasesForMunicipality__count">
        <![CDATA[
        select count(*) from (select count(DISTINCT ID) as count from CaseTypes where MunicipalityId=:MunicipalityId) wmTempTable
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="UpdatePrimaryVendorStatusInVEndor2Forms">
        <![CDATA[
        update Vendors2Form set PrimaryVendor=:pv where RelatedFormGUID=:form
        ]]>
    <query-param name="pv" type="java.lang.Boolean"/>
    <query-param name="form" type="java.lang.String"/>
    </sql-query>

    <query name="MunicipalityProjects">
        <![CDATA[
        from Projects where Active=:Active and MunicipalityId=:MunicipalityId ORDER BY ModifiedDate DESC
        ]]>
    <query-param name="Active" type="java.lang.Boolean"/>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </query>

    <query name="MunicipalityProjects__count">
        <![CDATA[
        select count(*) from Projects where Active=:Active and MunicipalityId=:MunicipalityId
        ]]>
    <query-param name="Active" type="java.lang.Boolean"/>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </query>

    <sql-query name="getMunicipalityGroupIdIDs">
        <![CDATA[
        select MunicipalityGroupId from MunicipalityGroupMembers where UserId =:userID
        ]]>
    <query-param name="userID" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="getMunicipalityGroupIdIDs__count">
        <![CDATA[
        select count(*) from (select MunicipalityGroupId from MunicipalityGroupMembers where UserId =:userID) wmTempTable
        ]]>
    <query-param name="userID" type="java.lang.Integer"/>
    </sql-query>

    <query name="UserSubscriptionsByMunicipality">
        <![CDATA[
        from UserSubscriptions where municipalityId=:municipalityId
        ]]>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    </query>

    <query name="UserSubscriptionsByMunicipality__count">
        <![CDATA[
        select count(*) from UserSubscriptions where municipalityId=:municipalityId
        ]]>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    </query>

    <sql-query name="FormsForUsersAndShared">
        <![CDATA[
        SELECT MF.FormGuid as formGuid,
	MF.FormTitle as formTitle,
	MU.MunicipalityName as municipalityName,
	U.FullName as createdBy,
	FT.FormType as formDesign,
	FS.Status as formStatus,
	GR.Lot as lot,
	GR.Subdivision as subdivision,
	GR.FullAddress as address,
	V.CompanyName as primaryVendor,
	MF.BalanceDue as balanceDue
FROM MasterForms MF
LEFT OUTER JOIN FormStatuses AS FS ON FS.ID=MF.FormStatusId
LEFT OUTER JOIN FormTypes AS FT ON FT.ID=MF.FormTypeId
LEFT OUTER JOIN Municipalities AS MU ON MU.ID=FT.MunicipalityId
LEFT JOIN Users AS U ON U.ID=MF.UserId
LEFT OUTER JOIN Vendor AS V ON V.ID=MF.CXVendorId
LEFT OUTER JOIN (SELECT ROW_NUMBER() OVER (PARTITION BY GF.RelatedFormGUID ORDER BY GF.AddedTime) AS rn,
				GF.RelatedFormGuid as formGuid,
				GR.Lot,
				SD.Subdivision,
				GR.FullAddress
				FROM GIS2Forms GF, GisRecords GR, Subdivisions SD
				WHERE GR.ID=GF.GISRecordId AND SD.ID=GR.SubdivisionId
) AS GR ON GR.FormGuid=MF.FormGUID AND GR.rn=1
where
    Closed=:closed and (UserId=:creatorUser or MF.FormGUID IN (select relatedGuid from SharedWith WHERE SharedWithUser = :sharedWithUser ))
    AND (:municipalityId IS NULL OR FT.MunicipalityId=:municipalityId)
ORDER BY DateModified DESC
        ]]>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="creatorUser" type="java.lang.Integer"/>
    <query-param name="sharedWithUser" type="java.lang.Integer"/>
    <query-param name="municipalityId" type="java.lang.Long"/>
    </sql-query>

    <sql-query name="getUserID">
        <![CDATA[
        select ID from Users where Email =:Email
        ]]>
    <query-param name="Email" type="java.lang.String"/>
    </sql-query>

    <sql-query name="getUserID__count">
        <![CDATA[
        select count(*) from (select ID from Users where Email =:Email) wmTempTable
        ]]>
    <query-param name="Email" type="java.lang.String"/>
    </sql-query>

    <sql-query name="getListofUsers">
        <![CDATA[
        select a.UserId , b.Email, b.FullName from Roles a INNER JOIN Users b on a.UserId = b.ID where a.RoleName IN ('MunicipalityEmployee','MunicipalityAdmin') and a.MunicipalityId =:municipalityID and (b.Email LIKE LOWER(concat('%',:Email,'%')) OR LOWER(b.FullName) LIKE LOWER(CONCAT('%',:Email,'%')))
        ]]>
    <query-param name="municipalityID" type="java.lang.Integer"/>
    <query-param name="Email" type="java.lang.String"/>
    </sql-query>

    <sql-query name="getListofUsers__count">
        <![CDATA[
        select count(*) from (select a.UserId , b.Email, b.FullName from Roles a INNER JOIN Users b on a.UserId = b.ID where a.RoleName IN ('MunicipalityEmployee','MunicipalityAdmin') and a.MunicipalityId =:municipalityID and (b.Email LIKE LOWER(concat('%',:Email,'%')) OR LOWER(b.FullName) LIKE LOWER(CONCAT('%',:Email,'%')))) wmTempTable
        ]]>
    <query-param name="municipalityID" type="java.lang.Integer"/>
    <query-param name="Email" type="java.lang.String"/>
    </sql-query>

    <sql-query name="InsertNewRole">
        <![CDATA[
        insert into Roles(RoleName,MunicipalityId,Description,UserId) values (:RoleName,:MunicipalityId,:Description,:UserId)
        ]]>
    <query-param name="RoleName" type="java.lang.String"/>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    <query-param name="Description" type="java.lang.String"/>
    <query-param name="UserId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="bannedDetails">
        <![CDATA[
        select Banned from Users where Email =:emailid
        ]]>
    <query-param name="emailid" type="java.lang.String"/>
    </sql-query>

    <sql-query name="bannedDetails__count">
        <![CDATA[
        select count(*) from (select Banned from Users where Email =:emailid) wmTempTable
        ]]>
    <query-param name="emailid" type="java.lang.String"/>
    </sql-query>

    <query name="GetVendorApprovalListByMunicipality">
        <![CDATA[
        from VendorApprovals where ApprovalStatus=:ApprovalStatus and MunicipalityId=:MunicipalityId and vendor.active=:a
        ]]>
    <query-param name="ApprovalStatus" type="java.lang.String"/>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    <query-param name="a" type="java.lang.Boolean"/>
    </query>

    <query name="GetVendorApprovalListByMunicipality__count">
        <![CDATA[
        select count(*) from VendorApprovals where ApprovalStatus=:ApprovalStatus and MunicipalityId=:MunicipalityId and vendor.active=:a
        ]]>
    <query-param name="ApprovalStatus" type="java.lang.String"/>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    <query-param name="a" type="java.lang.Boolean"/>
    </query>

    <sql-query name="deleteMunicipalityGroup">
        <![CDATA[
        delete from MunicipalityGroupMembers where MunicipalityGroupId =:MunicipalityGroupId AND UserId =:UserId
        ]]>
    <query-param name="MunicipalityGroupId" type="java.lang.Integer"/>
    <query-param name="UserId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="verifyPasswordResetToken">
        <![CDATA[
        select * from UserPasswordResetTokens WHERE( ExpirationDate >= GETDATE() AND Token = :token)
        ]]>
    <query-param name="token" type="java.lang.String"/>
    </sql-query>

    <sql-query name="verifyPasswordResetToken__count">
        <![CDATA[
        select count(*) from (select * from UserPasswordResetTokens WHERE( ExpirationDate >= GETDATE() AND Token = :token)) wmTempTable
        ]]>
    <query-param name="token" type="java.lang.String"/>
    </sql-query>

    <sql-query name="getListofGroupName">
        <![CDATA[
        select ID,GroupName from MunicipalityGroups where ID IN :MunicipalityGroupID AND MunicipalityId =:MunicipalityID
        ]]>
    <query-param name="MunicipalityGroupID" type="java.lang.Integer"/>
    <query-param name="MunicipalityID" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="getListofGroupName__count">
        <![CDATA[
        select count(*) from (select ID,GroupName from MunicipalityGroups where ID IN :MunicipalityGroupID AND MunicipalityId =:MunicipalityID) wmTempTable
        ]]>
    <query-param name="MunicipalityGroupID" type="java.lang.Integer"/>
    <query-param name="MunicipalityID" type="java.lang.Integer"/>
    </sql-query>

    <query name="GetProjectGisrecords">
        <![CDATA[
        from ProjectGisrecords where relatedProjectGuid=:relatedProjectGuid
        ]]>
    <query-param name="relatedProjectGuid" type="java.lang.String"/>
    </query>

    <query name="GetProjectGisrecords__count">
        <![CDATA[
        select count(*) from ProjectGisrecords where relatedProjectGuid=:relatedProjectGuid
        ]]>
    <query-param name="relatedProjectGuid" type="java.lang.String"/>
    </query>

    <sql-query name="SubDivisonCount">
        <![CDATA[
        select count(*) as SubDivisonCount from Subdivisions where MunicipalityId=:municipalityId
        ]]>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="SubDivisonCount__count">
        <![CDATA[
        select count(*) from (select count(*) as SubDivisonCount from Subdivisions where MunicipalityId=:municipalityId) wmTempTable
        ]]>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="DeleteAllMunicipalityRoles">
        <![CDATA[
        delete from Roles where MunicipalityId=:MunicipalityId and UserId=:UserId
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    <query-param name="UserId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="GetRolesForMunicipality">
        <![CDATA[
        select U.* from Users U,Roles R where  R.RoleName=:role and R.MunicipalityId=:municipality and R.UserId=U.ID
        ]]>
    <query-param name="role" type="java.lang.String"/>
    <query-param name="municipality" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="GetRolesForMunicipality__count">
        <![CDATA[
        select count(*) from (select U.* from Users U,Roles R where  R.RoleName=:role and R.MunicipalityId=:municipality and R.UserId=U.ID) wmTempTable
        ]]>
    <query-param name="role" type="java.lang.String"/>
    <query-param name="municipality" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="resetPasswordForUser">
        <![CDATA[
        UPDATE Users SET Password=:newPassword where ID in (select UserId from UserPasswordResetTokens where ExpirationDate >= GETDATE() and Token = :token)
        ]]>
    <query-param name="newPassword" type="java.lang.String"/>
    <query-param name="token" type="java.lang.String"/>
    </sql-query>

    <sql-query name="InsertGroups">
        <![CDATA[
        insert into MunicipalityGroups (GroupName,GroupDescription,MunicipalityId) values (:GroupName,:GroupDescription,:MunicipalityId)
        ]]>
    <query-param name="GroupName" type="java.lang.String"/>
    <query-param name="GroupDescription" type="java.lang.String"/>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="UpdateUserPreferences">
        <![CDATA[
        update UserViewPreferences set PreferenceId=:PreferenceId where UserId=:user
        ]]>
    <query-param name="PreferenceId" type="java.lang.Integer"/>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="AddGIStoForms">
        <![CDATA[
        insert into GIS2Forms(GISRecordId,RelatedFormGUID,AddedBy,AddedTime) values(:GISRecordId,:RelatedFormGUID,:AddedBy,:AddedTime)
        ]]>
    <query-param name="GISRecordId" type="java.lang.Integer"/>
    <query-param name="RelatedFormGUID" type="java.lang.String"/>
    <query-param name="AddedBy" type="java.lang.Integer"/>
    <query-param name="AddedTime" type="java.sql.Timestamp"/>
    </sql-query>

    <sql-query name="AddMemeberToProject">
        <![CDATA[
        insert into ProjectSharedWith(RelatedProjectGUID,ProjectSharedOn,ProjectSharedWithUser,ProjectSharedBy) values (:RelatedProjectGUID,:ProjectSharedOn,:ProjectSharedWith,:ProjectSharedBy)
        ]]>
    <query-param name="RelatedProjectGUID" type="java.lang.String"/>
    <query-param name="ProjectSharedOn" type="java.sql.Timestamp"/>
    <query-param name="ProjectSharedWith" type="java.lang.Integer"/>
    <query-param name="ProjectSharedBy" type="java.lang.Integer"/>
    </sql-query>

    <query name="getOwnersForGisRecords">
        <![CDATA[
        FROM Giscontacts WHERE contactType='Owner' AND active=1 AND gisRecordId IN :gisRecordIds
        ]]>
    <query-param name="gisRecordIds" type="java.lang.Integer"/>
    </query>

    <query name="getOwnersForGisRecords__count">
        <![CDATA[
        select count(*) FROM Giscontacts WHERE contactType='Owner' AND active=1 AND gisRecordId IN :gisRecordIds
        ]]>
    <query-param name="gisRecordIds" type="java.lang.Integer"/>
    </query>

    <sql-query name="InsertFormsToInspectionsMapping">
        <![CDATA[
        insert into FormsToInspections(RelatedFormGUID,RelatedInspectionGUID,AddedBy) values(:RelatedFormGUID,:RelatedInspectionGUID,:AddedBy)
        ]]>
    <query-param name="RelatedFormGUID" type="java.lang.String"/>
    <query-param name="RelatedInspectionGUID" type="java.lang.String"/>
    <query-param name="AddedBy" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="FetchRolesForUserWithMunicipality">
        <![CDATA[
        select * from Roles where UserId=:user and MunicipalityId=:municipality
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    <query-param name="municipality" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="FetchRolesForUserWithMunicipality__count">
        <![CDATA[
        select count(*) from (select * from Roles where UserId=:user and MunicipalityId=:municipality) wmTempTable
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    <query-param name="municipality" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="updateAssessFeeYN">
        <![CDATA[
        update InspectionOutcome set AssessFeeYN=:AssessFeeYN where ID=:id
        ]]>
    <query-param name="AssessFeeYN" type="java.lang.Boolean"/>
    <query-param name="id" type="java.lang.Integer"/>
    </sql-query>

    <query name="VendorsByMunicipalityAndStatus">
        <![CDATA[
        from Vendor where id in (select vendorId from VendorApprovals where municipalityId=:municipalityId and approvalStatus=:approvalStatus) and active=:active and lower(companyName) like lower('%'||:companyName||'%')
        ]]>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="approvalStatus" type="java.lang.String"/>
    <query-param name="active" type="java.lang.Boolean"/>
    <query-param name="companyName" type="java.lang.String"/>
    </query>

    <query name="VendorsByMunicipalityAndStatus__count">
        <![CDATA[
        select count(*) from Vendor where id in (select vendorId from VendorApprovals where municipalityId=:municipalityId and approvalStatus=:approvalStatus) and active=:active and lower(companyName) like lower('%'||:companyName||'%')
        ]]>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="approvalStatus" type="java.lang.String"/>
    <query-param name="active" type="java.lang.Boolean"/>
    <query-param name="companyName" type="java.lang.String"/>
    </query>

    <sql-query name="SetModifiedDateForProject">
        <![CDATA[
        Update Projects set ModifiedDate=:DateModified where ProjectGUID=:project
        ]]>
    <query-param name="DateModified" type="java.sql.Timestamp"/>
    <query-param name="project" type="java.lang.String"/>
    </sql-query>

    <sql-query name="CompanyFormsByVendorId">
        <![CDATA[
        SELECT MF.FormGuid as formGuid,
	MF.FormTitle as formTitle,
	MU.MunicipalityName as municipalityName,
	U.FullName as createdBy,
	FT.FormType as formDesign,
	FS.Status as formStatus,
	GR.Lot as lot,
	GR.Subdivision as subdivision,
	GR.FullAddress as address,
	V.CompanyName as primaryVendor,
	MF.BalanceDue as balanceDue
FROM MasterForms MF
LEFT OUTER JOIN FormStatuses AS FS ON FS.ID=MF.FormStatusId
LEFT OUTER JOIN FormTypes AS FT ON FT.ID=MF.FormTypeId
LEFT OUTER JOIN Municipalities AS MU ON MU.ID=FT.MunicipalityId
LEFT JOIN Users AS U ON U.ID=MF.UserId
LEFT JOIN MunicipalityGroups AS MG ON MG.id=FS.processOwners
LEFT OUTER JOIN Vendor AS V ON V.ID=MF.CXVendorId
LEFT OUTER JOIN (SELECT ROW_NUMBER() OVER (PARTITION BY GF.RelatedFormGUID ORDER BY GF.AddedTime) AS rn,
				GF.RelatedFormGuid as formGuid,
				GR.Lot,
				SD.Subdivision,
				GR.FullAddress
				FROM GIS2Forms GF, GisRecords GR, Subdivisions SD
				WHERE GR.ID=GF.GISRecordId AND SD.ID=GR.SubdivisionId
) AS GR ON GR.FormGuid=MF.FormGUID AND GR.rn=1
where
    Closed=:closed
	AND MF.FormGUID IN (select relatedFormGuid from Vendors2form where vendorId=:vendorId)
ORDER BY DateModified DESC
        ]]>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="vendorId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="UpdateInfoFromMyProfile">
        <![CDATA[
        Update Users set FirstName=:fn,LastName=:ln,Email=:em,PhoneNumber=:ph,Address1=:ad1,Address2=:ad2,StateId=:st,City=:ct,Country=:ctry,PostalCode=:pc where ID=:user
        ]]>
    <query-param name="fn" type="java.lang.String"/>
    <query-param name="ln" type="java.lang.String"/>
    <query-param name="em" type="java.lang.String"/>
    <query-param name="ph" type="java.lang.String"/>
    <query-param name="ad1" type="java.lang.String"/>
    <query-param name="ad2" type="java.lang.String"/>
    <query-param name="st" type="java.lang.Integer"/>
    <query-param name="ct" type="java.lang.String"/>
    <query-param name="ctry" type="java.lang.String"/>
    <query-param name="pc" type="java.lang.String"/>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="resetPasswordWithTokenForUser">
        <![CDATA[
        DELETE FROM UserPasswordResetTokens WHERE UserId = :userid 
INSERT INTO UserPasswordResetTokens (UserId, Token, ExpirationDate) VALUES ( :userid, :token, DATEADD(day, 2, GETDATE()))
        ]]>
    <query-param name="userid" type="java.lang.Integer"/>
    <query-param name="token" type="java.lang.String"/>
    </sql-query>

    <query name="VendorsLinkedWithForm">
        <![CDATA[
        from Vendor where id IN (select vendorId from Vendors2form where relatedFormGuid=:RelatedFormGUID)
        ]]>
    <query-param name="RelatedFormGUID" type="java.lang.String"/>
    </query>

    <query name="VendorsLinkedWithForm__count">
        <![CDATA[
        select count(*) from Vendor where id IN (select vendorId from Vendors2form where relatedFormGuid=:RelatedFormGUID)
        ]]>
    <query-param name="RelatedFormGUID" type="java.lang.String"/>
    </query>

    <sql-query name="UpdateRoleForMunicipality">
        <![CDATA[
        update Roles set RoleName=:role where MunicipalityId=:municipality and UserId=:user
        ]]>
    <query-param name="role" type="java.lang.String"/>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="GetFormsForMunicpality">
        <![CDATA[
        select DISTINCT * from FormTypes where MunicipalityId=:MunicipalityId
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="GetFormsForMunicpality__count">
        <![CDATA[
        select count(*) from (select DISTINCT * from FormTypes where MunicipalityId=:MunicipalityId) wmTempTable
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="UpdateProcessOwnersForGUID">
        <![CDATA[
        update MasterForms set AssignedToGroupId=:AssignedToGroupId where FormGUID=:GUID
        ]]>
    <query-param name="AssignedToGroupId" type="java.lang.Integer"/>
    <query-param name="GUID" type="java.lang.String"/>
    </sql-query>

    <query name="SearchFormByVendor">
        <![CDATA[
        from MasterForms where DateSubmitted BETWEEN :startd and :endd and FormTypeId=:FormTypeId and municipalityId=:municipalityId and  Closed=:closed and  FormGUID IN (select relatedFormGuid from Vendors2form where vendorId=:vendorId ) ORDER BY DateModified DESC
        ]]>
    <query-param name="startd" type="java.sql.Timestamp"/>
    <query-param name="endd" type="java.sql.Timestamp"/>
    <query-param name="FormTypeId" type="java.lang.Integer"/>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="vendorId" type="java.lang.Integer"/>
    </query>

    <query name="SearchFormByVendor__count">
        <![CDATA[
        select count(*) from MasterForms where DateSubmitted BETWEEN :startd and :endd and FormTypeId=:FormTypeId and municipalityId=:municipalityId and  Closed=:closed and  FormGUID IN (select relatedFormGuid from Vendors2form where vendorId=:vendorId )
        ]]>
    <query-param name="startd" type="java.sql.Timestamp"/>
    <query-param name="endd" type="java.sql.Timestamp"/>
    <query-param name="FormTypeId" type="java.lang.Integer"/>
    <query-param name="municipalityId" type="java.lang.Integer"/>
    <query-param name="closed" type="java.lang.Boolean"/>
    <query-param name="vendorId" type="java.lang.Integer"/>
    </query>

    <sql-query name="UpdateProjectDescription">
        <![CDATA[
        Update Projects set ProjectDescription=:ProjectDescription where ProjectGUID=:project
        ]]>
    <query-param name="ProjectDescription" type="java.lang.String"/>
    <query-param name="project" type="java.lang.String"/>
    </sql-query>

    <query name="AllFeesOfFormsForCreatedByAndSharedWith">
        <![CDATA[
        select 
id as feeId,
masterForms.formGuid as formGuid,
masterForms.formTitle as formTitle,
masterForms.formTypes.formType as FormType,
masterForms.formTypes.municipalities.municipalityName as municipality,
masterForms.giscontacts.gisrecords.fullAddress as address,
feeType as feeType,
amount as amount
from Fees where masterForms.formStatuses.allowPayment=:allowPayment and paidStatus=:paidStatus and formGuid IN 
       (select formGuid from MasterForms where userId=:userId or formGuid IN 
              (select relatedGuid from  SharedWith where sharedWithUser = :userId)
        )
        ]]>
    <query-param name="allowPayment" type="java.lang.Boolean"/>
    <query-param name="paidStatus" type="java.lang.String"/>
    <query-param name="userId" type="java.lang.Integer"/>
    </query>

    <query name="AllFeesOfFormsForCreatedByAndSharedWith__count">
        <![CDATA[
        select count(*)  from MasterForms where userId=:userId or formGuid IN 
              (select relatedGuid from  SharedWith where sharedWithUser = :userId)
        )
        ]]>
    <query-param name="allowPayment" type="java.lang.Boolean"/>
    <query-param name="paidStatus" type="java.lang.String"/>
    <query-param name="userId" type="java.lang.Integer"/>
    </query>

    <sql-query name="VendorsCountForMunicipalities">
        <![CDATA[
        select count(*) as vendorsCount from VendorApprovals where MunicipalityId=:MunicipalityId
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="VendorsCountForMunicipalities__count">
        <![CDATA[
        select count(*) from (select count(*) as vendorsCount from VendorApprovals where MunicipalityId=:MunicipalityId) wmTempTable
        ]]>
    <query-param name="MunicipalityId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="getRolesForUser">
        <![CDATA[
        SELECT RoleName, MunicipalityId FROM Roles WHERE UserId=:userId
        ]]>
    <query-param name="userId" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="getRolesForUser__count">
        <![CDATA[
        select count(*) from (SELECT RoleName, MunicipalityId FROM Roles WHERE UserId=:userId) wmTempTable
        ]]>
    <query-param name="userId" type="java.lang.Integer"/>
    </sql-query>

    <query name="countAssignedInspectionsLessThanDate">
        <![CDATA[
        select 
count(*) as inspectionsCount

from MasterInspections where inspectionDesign.municipalities.id=:municipality and closed=:isClosed and assignedTo=:assignedTo and requestedFor<:requestedFor
        ]]>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="isClosed" type="java.lang.Boolean"/>
    <query-param name="assignedTo" type="java.lang.Integer"/>
    <query-param name="requestedFor" type="org.joda.time.LocalDateTime"/>
    </query>

    <sql-query name="DeleteFromVendorUsers">
        <![CDATA[
        delete from VendorUsers where UserId=:user and VendorId=:vendor
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CheckingUserWithInVendorUsers">
        <![CDATA[
        select count(*) as exist from VendorUsers where UserId=:user and VendorId=:vendor
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CheckingUserWithInVendorUsers__count">
        <![CDATA[
        select count(*) from (select count(*) as exist from VendorUsers where UserId=:user and VendorId=:vendor) wmTempTable
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="UpdateVendorStatus">
        <![CDATA[
        Update VendorApprovals set DateApproved=:DateApproved,ApprovedBy=:ApprovedBy,ExpiresDate=:ExpiresDate,ApprovalStatus=:ApprovalStatus,Reviewer=:Reviewer where MunicipalityId=:municipality and VendorId=:vendor
        ]]>
    <query-param name="DateApproved" type="java.sql.Timestamp"/>
    <query-param name="ApprovedBy" type="java.lang.String"/>
    <query-param name="ExpiresDate" type="java.sql.Timestamp"/>
    <query-param name="ApprovalStatus" type="java.lang.String"/>
    <query-param name="Reviewer" type="java.lang.String"/>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="DeleteProjectForms">
        <![CDATA[
        delete from ProjectForms where ID=:projectForm
        ]]>
    <query-param name="projectForm" type="java.lang.Integer"/>
    </sql-query>

    <query name="InspectionDesignForCategoriesMappedToForms">
        <![CDATA[
        from InspectionDesign where id IN(select inspectionDesignId from InspectionCategoryMapping where inspectionCategoryId IN(select inspectionCategoryId from FormToInspectionCategoryMapping where formTypeId= :formTypeId))
        ]]>
    <query-param name="formTypeId" type="java.lang.Integer"/>
    </query>

    <query name="InspectionDesignForCategoriesMappedToForms__count">
        <![CDATA[
        select count(*) from InspectionDesign where id IN(select inspectionDesignId from InspectionCategoryMapping where inspectionCategoryId IN(select inspectionCategoryId from FormToInspectionCategoryMapping where formTypeId= :formTypeId))
        ]]>
    <query-param name="formTypeId" type="java.lang.Integer"/>
    </query>

    <query name="GetGis2formsByForm">
        <![CDATA[
        from Gis2forms where relatedFormGuid=:relatedFormGuid
        ]]>
    <query-param name="relatedFormGuid" type="java.lang.String"/>
    </query>

    <query name="GetGis2formsByForm__count">
        <![CDATA[
        select count(*) from Gis2forms where relatedFormGuid=:relatedFormGuid
        ]]>
    <query-param name="relatedFormGuid" type="java.lang.String"/>
    </query>

    <query name="UnpaidFormFeeCount">
        <![CDATA[
        select 
count (*) as count
from Fees where masterForms.formStatuses.allowPayment=:allowPayment and paidStatus=:paidStatus and formGuid IN 
       (select formGuid from MasterForms where userId=:userId or formGuid IN 
              (select relatedGuid from  SharedWith where sharedWithUser = :userId)
        )
        ]]>
    <query-param name="allowPayment" type="java.lang.Boolean"/>
    <query-param name="paidStatus" type="java.lang.String"/>
    <query-param name="userId" type="java.lang.Integer"/>
    </query>

    <query name="UnpaidFormFeeCount__count">
        <![CDATA[
        select count(*)  from MasterForms where userId=:userId or formGuid IN 
              (select relatedGuid from  SharedWith where sharedWithUser = :userId)
        )
        ]]>
    <query-param name="allowPayment" type="java.lang.Boolean"/>
    <query-param name="paidStatus" type="java.lang.String"/>
    <query-param name="userId" type="java.lang.Integer"/>
    </query>

    <query name="getInspectionsToBeScheduledByMunicipality">
        <![CDATA[
        select 
count(*)
as inspectionsToBeScheduled
from MasterInspections where inspectionDesign.municipalities.id=:municipality and inspectionOutcome.outcome=:outcome and assignedTo is null
        ]]>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="outcome" type="java.lang.String"/>
    </query>

    <query name="FormsTypesForDashboard">
        <![CDATA[
        select formTypes.formType as formType ,count(formGuid) as counts from MasterForms where municipalityId=:municipality and DateSubmitted BETWEEN :startDate and :endDate
group by formTypes.formType
        ]]>
    <query-param name="municipality" type="java.lang.Integer"/>
    <query-param name="startDate" type="java.sql.Timestamp"/>
    <query-param name="endDate" type="java.sql.Timestamp"/>
    </query>

    <sql-query name="DeleteExistingSubscriptionsForUser">
        <![CDATA[
        delete from UserSubscriptions where UserId=:user
        ]]>
    <query-param name="user" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="MunicipalityCount">
        <![CDATA[
        select count(*) as municipalitiesCount from Municipalities
        ]]>
    </sql-query>

    <sql-query name="MunicipalityCount__count">
        <![CDATA[
        select count(*) from (select count(*) as municipalitiesCount from Municipalities) wmTempTable
        ]]>
    </sql-query>

    <sql-query name="userSubscriptionsCount">
        <![CDATA[
        select count(*) as userSubscriptionsCount from UserSubscriptions
        ]]>
    </sql-query>

    <sql-query name="userSubscriptionsCount__count">
        <![CDATA[
        select count(*) from (select count(*) as userSubscriptionsCount from UserSubscriptions) wmTempTable
        ]]>
    </sql-query>

    <sql-query name="InsertFormMessage">
        <![CDATA[
        insert into FormMessages(UserId,RelatedFormGUID,Message,MunicipalityMessage) values(:UserId,:RelatedFormGUID,:Message,:MunicipalityMessage)
        ]]>
    <query-param name="UserId" type="java.lang.Integer"/>
    <query-param name="RelatedFormGUID" type="java.lang.String"/>
    <query-param name="Message" type="java.lang.String"/>
    <query-param name="MunicipalityMessage" type="java.lang.Boolean"/>
    </sql-query>

    <query name="ProjectsForUsersAndSharedWith">
        <![CDATA[
        from Projects where Active=:Active and (CreatedBy=:creatorUser or ProjectGUID IN (select relatedProjectGuid from  ProjectSharedWith where ProjectSharedWithUser = :sharedWithUser )) AND (:municipalityId IS NULL OR MunicipalityId=:municipalityId) ORDER BY ModifiedDate DESC
        ]]>
    <query-param name="Active" type="java.lang.Boolean"/>
    <query-param name="creatorUser" type="java.lang.Integer"/>
    <query-param name="sharedWithUser" type="java.lang.Integer"/>
    <query-param name="municipalityId" type="java.lang.Long"/>
    </query>

    <query name="ProjectsForUsersAndSharedWith__count">
        <![CDATA[
        select count(*) from Projects where Active=:Active and (CreatedBy=:creatorUser or ProjectGUID IN (select relatedProjectGuid from  ProjectSharedWith where ProjectSharedWithUser = :sharedWithUser )) AND (:municipalityId IS NULL OR MunicipalityId=:municipalityId)
        ]]>
    <query-param name="Active" type="java.lang.Boolean"/>
    <query-param name="creatorUser" type="java.lang.Integer"/>
    <query-param name="sharedWithUser" type="java.lang.Integer"/>
    <query-param name="municipalityId" type="java.lang.Long"/>
    </query>

    <sql-query name="UpdateNewPassword">
        <![CDATA[
        UPDATE Users SET Password=:password where ID=:newUser
        ]]>
    <query-param name="password" type="java.lang.String"/>
    <query-param name="newUser" type="java.lang.Integer"/>
    </sql-query>

    <query name="FormsTaggedWithGISRecords">
        <![CDATA[
        from MasterForms where FormGUID IN (select relatedFormGuid from Gis2forms where gisrecordId=:gisrecordId ) ORDER BY DateModified DESC
        ]]>
    <query-param name="gisrecordId" type="java.lang.Integer"/>
    </query>

    <query name="FormsTaggedWithGISRecords__count">
        <![CDATA[
        select count(*) from MasterForms where FormGUID IN (select relatedFormGuid from Gis2forms where gisrecordId=:gisrecordId )
        ]]>
    <query-param name="gisrecordId" type="java.lang.Integer"/>
    </query>

    <sql-query name="CountOfVendorUsers">
        <![CDATA[
        select count(*) as CountOfVendorUsers from VendorUsers where VendorId=:vendor
        ]]>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="CountOfVendorUsers__count">
        <![CDATA[
        select count(*) from (select count(*) as CountOfVendorUsers from VendorUsers where VendorId=:vendor) wmTempTable
        ]]>
    <query-param name="vendor" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="getInspectionDesignByInspectionCategoriesAssignedToFormType">
        <![CDATA[
        select I.ID , I.InspectDesignName,I.MaxDaysInAdvance,I.AllowSameDayInspections
from 
InspectionDesign I,
InspectionCategoryMapping ICM,
InspectionCategories IC,
FormToInspectionCategoryMapping FICM
where
FICM.FormTypeId=:formType and FICM.InspectionCategoryId=IC.ID
and IC.ID=ICM.InspectionCategoryId and ICM.InspectionDesignId=I.ID
        ]]>
    <query-param name="formType" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="getInspectionDesignByInspectionCategoriesAssignedToFormType__count">
        <![CDATA[
        select count(*) from (select I.ID , I.InspectDesignName,I.MaxDaysInAdvance,I.AllowSameDayInspections
from 
InspectionDesign I,
InspectionCategoryMapping ICM,
InspectionCategories IC,
FormToInspectionCategoryMapping FICM
where
FICM.FormTypeId=:formType and FICM.InspectionCategoryId=IC.ID
and IC.ID=ICM.InspectionCategoryId and ICM.InspectionDesignId=I.ID) wmTempTable
        ]]>
    <query-param name="formType" type="java.lang.Integer"/>
    </sql-query>

    <sql-query name="InsertProjectMessage">
        <![CDATA[
        insert into FormMessages(UserId,RelatedProjectGUID,Message,PostedAt,MunicipalityMessage) values(:UserId,:RelatedProjectGUID,:Message,:PostedAt,:MunicipalityMessage)
        ]]>
    <query-param name="UserId" type="java.lang.Integer"/>
    <query-param name="RelatedProjectGUID" type="java.lang.String"/>
    <query-param name="Message" type="java.lang.String"/>
    <query-param name="PostedAt" type="java.sql.Timestamp"/>
    <query-param name="MunicipalityMessage" type="java.lang.Boolean"/>
    </sql-query>
</hibernate-mapping>
